<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="icon" href="/assets/images/favicon.ico" type="image/x-icon"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Setup a minimal LDES client | Onboarding tutorial</title> <meta name="generator" content="Jekyll v3.9.3" /> <meta property="og:title" content="Setup a minimal LDES client" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Github repo" /> <meta property="og:description" content="Github repo" /> <link rel="canonical" href="http://localhost:4000/consuming/consuming" /> <meta property="og:url" content="http://localhost:4000/consuming/consuming" /> <meta property="og:site_name" content="Onboarding tutorial" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2024-02-19T16:24:28+01:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Setup a minimal LDES client" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-02-19T16:24:28+01:00","datePublished":"2024-02-19T16:24:28+01:00","description":"Github repo","headline":"Setup a minimal LDES client","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/consuming/consuming"},"url":"http://localhost:4000/consuming/consuming"}</script> <!-- End Jekyll SEO tag --> <div class="test-header" data-v-df634f57="" data-v-7a7a37b1=""> <div class="global-header" data-v-df634f57=""><img src="/assets/images/LOGO_Vlaanderen_NIV2.svg" alt="Vlaanderen" data-v-df634f57=""><img class="small-global-header-divider" src="/assets/images/divider_globalheader.svg" alt="divider" data-v-df634f57=""><span class="header-title header-font" data-v-df634f57="">Vlaamse Smart Data Space</span><span class="spacer" data-v-df634f57=""></span> <div id="help-needed" data-v-df634f57=""><span class="header-font" data-v-df634f57="">Hulp nodig</span><a id="help" href="https://www.vlaanderen.be/vlaamse-smart-data-space-portaal/contact"><img class="question-menu-item" src="/assets/images/question-mark.svg" alt="?" data-v-df634f57=""></a></div> </div> <hr class="divider" data-v-df634f57=""> </div> <div class="navbar navbar-fixed-top"> <div class="navbar-inner"> <div class="container-fluid"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" crossorigin="anonymous"> <a href="https://informatievlaanderen.github.io/VSDS-Tech-Docs/"> <button type="button" class="btn btn-navbar custom-border" > <span class="nav-icon-bar">Home</span> </button> </a> <a href="https://github.com/Informatievlaanderen/VSDS-Onboarding-Example"> <button type="button" class="btn btn-navbar custom-border-activated" > <span class="nav-icon-bar">Tutorial</span> </button> </a> <a href="https://informatievlaanderen.github.io/VSDS-Linked-Data-Interactions/"> <button type="button" class="btn btn-navbar custom-border" > <span class="nav-icon-bar">Linked Data Interactions</span> </button> </a> <a href="https://informatievlaanderen.github.io/VSDS-LDESServer4J/"> <button type="button" class="btn btn-navbar custom-border" > <span class="nav-icon-bar">LDES server</span> </button> </a> <a href="https://informatievlaanderen.github.io/VSDS-Linked-Data-Interactions/ldio/ldio-inputs/ldio-ldes-client"> <button type="button" class="btn btn-navbar custom-border" > <span class="nav-icon-bar">LDES client</span> </button> </a> <a href="https://www.vlaanderen.be/vlaamse-smart-data-space-portaal/blog"> <button type="button" class="btn btn-navbar custom-border" > <span class="nav-icon-bar">Blog posts</span> </button> </a> <a href="https://informatievlaanderen.github.io/OSLO-mapping/"> <button type="button" class="btn btn-navbar custom-border" > <span class="nav-icon-bar">OSLO mapping</span> </button> </a> </div> </div> </div> <style> #help-needed[data-v-df634f57] { display: flex; align-items: center; gap: 5px; background-image: url(https://informatievlaanderen.github.io/OSLO-mapping/assets/images/hulp_nodig.svg); width: 144px; height: 44px; } .custom-border-activated { background-color: rgb(255, 230, 21); } .custom-border { border: 0.3px solid rgb(0, 200, 171); /* Randkleur */ /* Voeg hier eventueel andere stijlelementen toe */ } .navbar-fixed-top .navbar-inner { margin-top:30px; height: 35px; padding: 0; border-top: 1px solid #d4d4d4; z-index: 1000; position: fixed; right:0px; } @media (min-width: 50rem) .navbar-fixed-top { position: relative !important; width: auto !important; height: 100% !important; padding: 0; transition: none; } .global-header[data-v-df634f57] { display: flex; margin-left: 0px; align-items: center; position: fixed; width: 100%; background-color: white; z-index: 100; } .test-header{ margin-bottom: 20px; overflow:hidden; z-index: 100; } element.style { } .small-global-header-divider[data-v-df634f57] { margin: 0 8px 0 4px; } .header-font { color: #333332; font-family: Flanders Art Sans, sans-serif; font-size: 12px; font-style: normal; font-weight: 500; line-height: normal; letter-spacing: 0.5px; text-transform: uppercase; } .spacer { flex-grow: 1; } .divider { border: 1px solid #8f8f8f66; margin: 0; } #help-needed > span[data-v-df634f57] { margin-left: 25px; } /* title of the site */ #header { height: 80px; } #header hgroup { position: absolute; top: 10px; left: 20px; } #header h1 { margin: 0; font-size: 1.75em; font-weight: bold; } #header h2 { color: #ccc; margin: 0 0 4px 16px; line-height: 0.8; font-size: 1.0em; font-weight: normal; } #header a, #header a:hover, #header a:visited { text-decoration: none; } .navbar .nav > .active > a, .navbar .nav > .active > a:hover, .navbar .nav > .active > a:focus { box-shadow: none; } .navbar .btn-navbar { margin-bottom: 5px; } </style> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> Onboarding tutorial </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Onboarding tutorial</a></li></ul> <div class="nav-category">Publishing an LDES</div> <ul class="nav-list"><li class="nav-list-item"><a href="/publishing/basic_setup" class="nav-list-link">Basic setup</a></li><li class="nav-list-item"><a href="/publishing/minimal_server" class="nav-list-link">Minimal Server</a></li></ul> <div class="nav-category">Data pipeline</div> <ul class="nav-list"><li class="nav-list-item"><a href="/pipeline/minimal_workbench" class="nav-list-link">Minimal workbench</a></li><li class="nav-list-item"><a href="/pipeline/advanced_conversion" class="nav-list-link">Advanced conversion</a></li></ul> <div class="nav-category">Consuming an LDES</div> <ul class="nav-list"><li class="nav-list-item"><a href="/consuming/consuming_public_ldes" class="nav-list-link">Consume a public LDES</a></li><li class="nav-list-item active"><a href="/consuming/consuming" class="nav-list-link active">Setup a minimal LDES client</a></li></ul> <div class="nav-category">Protected LDES</div> <ul class="nav-list"><li class="nav-list-item"><a href="/protected/publishing_protected_LDES" class="nav-list-link">Publishing a protected LDES</a></li></ul> <div class="nav-category">Republish an LDES</div> <ul class="nav-list"><li class="nav-list-item"><a href="/republish/republish" class="nav-list-link">Republish an LDES</a></li></ul> </nav> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Onboarding tutorial" aria-label="Search Onboarding tutorial" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content"> <main> <p><b><a href="https://github.com/Informatievlaanderen/VSDS-Onboarding-Example/tree/main/minimal-client">Github repo</a></b></p> <h1 id="setting-up-a-minimal-ldes-client"> <a href="#setting-up-a-minimal-ldes-client" class="anchor-heading" aria-labelledby="setting-up-a-minimal-ldes-client"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Setting Up a Minimal LDES Client </h1> <p>This tutorial will show you how to setup a minimal LDES CLient in order to replicate and synchronize an existing Linked Data Event Stream (LDES).</p> <p>Please see the <a href="../index.html">introduction</a> for the example data set and pre-requisites, as well as an overview of all examples.</p> <h2 id="ldes-in-a-nutshell"> <a href="#ldes-in-a-nutshell" class="anchor-heading" aria-labelledby="ldes-in-a-nutshell"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> LDES in a Nutshell </h2> <p>If you look at the <a href="https://treecg.github.io/specification/">Tree specification</a> you will see that an LDES (which derives from this specification) is a <em>collection of views</em>. A view is in fact the first node of a tree of nodes containing <em>members</em> of the collection as well as <em>relations</em> to other nodes. Wow, let us take a moment here to reflect about this. So, we have a data collection containing collection members. The size of the collection is potentially very big so a LDES allows us to split the collection in pieces. Each view is in fact a collection of connected nodes which may contain a number of collection members as well as links to other nodes which allow us to traverse the whole connected structure. So, by following all the links in the nodes of a view we can collect all the members of the data collection. Each view is organized in some way: the nodes may together form a list, a tree or a graph. This organization comes into existence by a process we call <em>fragmentation</em>: creating a structure of nodes by adding zero or more relations (containing a link to another node) to each node as well as assigning a collection member to one or more nodes.</p> <p>As said, the <a href="https://semiceu.github.io/LinkedDataEventStreams/">LDES specification</a> is based on the <a href="https://treecg.github.io/specification/">Tree specification</a> and provides a way to keep the history of changes of a data collection. The result is a <em>dynamic data collection</em> and the members of a LDES are <em>version objects</em> instead of <em>state objects</em>. So, a version object is in essence a state object at some point in time. An LDES allows us to <em>replicate</em> the data collection in addition to <em>synchronize</em> with the changes that occur to this data collection after we have retrieved it. This allows us to keep in sync with the historical state of a system.</p> <h2 id="all-the-things-she-said"> <a href="#all-the-things-she-said" class="anchor-heading" aria-labelledby="all-the-things-she-said"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> All The Things She Said </h2> <p>Suppose there is a public LDES available out there that you would like to use. We will assume that you know the URL of this LDES. If not, you will need to discover the URL by looking at some metadata catalog such as <a href="https://metadata.vlaanderen.be/">Metadata Vlaanderen</a>.</p> <p>Once we have the URL of the LDES we can choose one of its views because as stated before each view allows us to retrieve all the members of the LDES by following all the links in the connected nodes. There is no point in following the links in multiple views of an LDES as we end up collecting the same members multiple times.</p> <p>OK, so we have a LDES URL (e.g. <code class="language-plaintext highlighter-rouge">http://localhost:9003/ldes/occupancy</code>) and we have selected a view URL by retrieving the LDES itself and selecting one of the <code class="language-plaintext highlighter-rouge">tree:view</code>s of the <code class="language-plaintext highlighter-rouge">ldes:EventStream</code>, e.g. <code class="language-plaintext highlighter-rouge">http://localhost:9003/ldes/occupancy/by-page</code>. Now what? For sure we are not going to extract all the members from each node or get all the links to the other nodes by hand. Are we? There can be thousands or millions of nodes and members! Well, of course not.</p> <p>Lucky for you we have already done the hard part of creating a LDES Client, which is a freely available component that allows us to, given a LDES or a view, request the view node or any linked node, extract each member from the node and follow the links in each node in order to collect all members and in fact <em>replicate</em> the LDES. In addition, the LDES Client will also look at the node properties which are lokated in the HTTP headers and re-request the nodes that can change over time, both nodes structure and nodes containing members. By doing this we can <em>synchronize</em> the LDES.</p> <p>The LDES CLient component is packaged as a <a href="https://github.com/Informatievlaanderen/VSDS-Linked-Data-Interactions/tree/main/ldi-orchestrator/ldio-connectors/ldio-ldes-client">LDIO input component</a> as well as a <a href="https://github.com/Informatievlaanderen/VSDS-Linked-Data-Interactions/tree/main/ldi-nifi/ldi-nifi-processors/ldes-client-processor">NiFi processor</a> and comes as part of their respective docker images (<a href="https://hub.docker.com/r/ldes/ldi-orchestrator">LDIO workbench</a> and <a href="https://hub.docker.com/r/ldes/ldi-workbench-nifi">Nifi workbench</a>). Both components act as the initial part of a data pipeline and need sink component which receives the extracted collection members which as you already know are version objects. But if you do not need the history of state changes you need a way to revert these version objects back to their corresponding state object. This process of converting such a <em>version object</em> back to a <em>state object</em> we call <em>version materialization</em>, and as it happens we have a component laying around that you can use to do exactly that.</p> <blockquote> <p><strong>Note</strong>: currently the LDES Client outputs a stream of version objects and you need to add a transformation step in your data pipeline to do version materialization. In the future we will likely add the option to immediately output state objects instead, or even default to that with the option to output the version objects in you do need the history. Stay tuned.</p> </blockquote> <p>No doubt you are thinking by now: ‘yeah, yeah, enough with that, just show me how!’ OK then, if you insist…</p> <h2 id="get-your-motor-runnin"> <a href="#get-your-motor-runnin" class="anchor-heading" aria-labelledby="get-your-motor-runnin"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Get Your Motor Runnin’ </h2> <p>For the LDES we can simply use the <a href="../advanced-conversion/README.md">parking lot example</a>. For this LDES we know that there is only one view, i.e. <code class="language-plaintext highlighter-rouge">http://localhost:9003/ldes/occupancy/by-page</code>.</p> <p>Go ahead and open a command shell at the parking lot example and run it so that we have a LDES to work with. Done? Let’s continue then.</p> <p>Now what do we need for our minimal LDES Client example? Really not that much! We obviouly need a workbench (e.g. LDIO) containing one pipeline which starts with a <a href="https://informatievlaanderen.github.io/VSDS-Linked-Data-Interactions/ldio/ldio-inputs/ldio-ldes-client">LDES Client component</a> and outputs the members to a sink. Unless we want to convert to state objects, we do not need a <a href="https://informatievlaanderen.github.io/VSDS-Linked-Data-Interactions/ldio/ldio-transformers/ldio-version-materializer">Version Materializer</a> transformer. For the sink we can use a webhook such as https://webhook.site/ or https://public.requestbin.com/ or any other similar online or offline service (e.g. our <a href="https://github.com/Informatievlaanderen/VSDS-LDES-E2E-message-sink">message sink</a>). You can use any sink for which we have an <a href="https://informatievlaanderen.github.io/VSDS-Linked-Data-Interactions/ldio/ldio-outputs/index">output component</a>. We will be using the HTTP protocol in this tutorial so we can use a <a href="https://informatievlaanderen.github.io/VSDS-Linked-Data-Interactions/ldio/ldio-outputs/ldio-http-out">HTTP output component</a> to output member to the sink where we can inspect.</p> <p>So, the input part of our pipeline will look something like this:</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">Ldio:LdesClient</span>
<span class="na">config</span><span class="pi">:</span>
  <span class="na">urls</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">http://localhost:9003/ldes/occupancy/by-page</span>
</code></pre></div></div> <p>That’s all folks. Short and simple.</p> <p>Now for the output:</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">Ldio:HttpOut</span>
<span class="na">config</span><span class="pi">:</span>
  <span class="na">endpoint</span><span class="pi">:</span> <span class="s">https://webhook.site/287d6ad6-b339-42fc-8b5e-297714ac688c</span>
</code></pre></div></div> <p>It is as simple as the input part!</p> <p>OK, OK, if you look at the <a href="./application.yml">workbench configuration</a> you will notice that it is a bit more elaborate than the above:</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">client-pipeline</span>
  <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Requests</span><span class="nv"> </span><span class="s">all</span><span class="nv"> </span><span class="s">existing</span><span class="nv"> </span><span class="s">members</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">public</span><span class="nv"> </span><span class="s">LDES</span><span class="nv"> </span><span class="s">server</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">keeps</span><span class="nv"> </span><span class="s">following</span><span class="nv"> </span><span class="s">it</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">changes,</span><span class="nv"> </span><span class="s">sending</span><span class="nv"> </span><span class="s">each</span><span class="nv"> </span><span class="s">member</span><span class="nv"> </span><span class="s">as-is</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">webhook"</span>
  <span class="na">input</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">Ldio:LdesClient</span>
    <span class="na">config</span><span class="pi">:</span>
      <span class="na">urls</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">${LDES_SERVER_URL}</span>
      <span class="na">sourceFormat</span><span class="pi">:</span> <span class="s">application/n-quads</span>
  <span class="na">outputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Ldio:HttpOut</span>
      <span class="na">config</span><span class="pi">:</span>
        <span class="na">endpoint</span><span class="pi">:</span> <span class="s">${SINK_URL}</span>
        <span class="na">rate-limit</span><span class="pi">:</span>
          <span class="na">enabled</span><span class="pi">:</span> <span class="no">true</span>
          <span class="na">max-requests-per-minute</span><span class="pi">:</span> <span class="s">${MAX_REQUESTS_PER_MINUTE}</span>
</code></pre></div></div> <p>But that is because we made it a bit more generic by using environment variables for the LDES Client <code class="language-plaintext highlighter-rouge">url</code> and the HTTP output <code class="language-plaintext highlighter-rouge">endpoint</code>. In addition, we added the <code class="language-plaintext highlighter-rouge">sourceFormat: application/n-quads</code> to request the LDES nodes as N-quads instead of the default format JSON-LD because N-quads can be parsed way faster. Finally we also added the <code class="language-plaintext highlighter-rouge">rate-limit</code> section because depending on which online sink service you use, you may be limited into how many HTTP requests you can send to it (usually a free sink service is limited to a minimal amout, e.g. 50 requests/minute). But in the end let’s be honest: it is not that complicated.</p> <p>The <a href="./docker-compose.yml">docker compose</a> file isn’t all that scary either. We just need one workbench service which looks like this:</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">ldio-workbench</span><span class="pi">:</span>
  <span class="na">container_name</span><span class="pi">:</span> <span class="s">basic-client_ldio-workbench</span>
  <span class="na">image</span><span class="pi">:</span> <span class="s">ldes/ldi-orchestrator:2.0.0-SNAPSHOT</span> <span class="c1"># you can safely change this to the latest 1.x.y version</span>
  <span class="na">environment</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">LDES_SERVER_URL=${LDES_SERVER_URL:-http://localhost:9003/ldes/occupancy/by-page}</span>
    <span class="pi">-</span> <span class="s">SINK_URL=${SINK_URL}</span>
    <span class="pi">-</span> <span class="s">MAX_REQUESTS_PER_MINUTE=${MAX_REQUESTS_PER_MINUTE:-50}</span>
  <span class="na">volumes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">./application.yml:/ldio/application.yml:ro</span>
  <span class="na">network_mode</span><span class="pi">:</span> <span class="s2">"</span><span class="s">host"</span>
</code></pre></div></div> <p>We give the container a name and use a recent <a href="https://hub.docker.com/r/ldes/ldi-orchestrator/tags">LDIO image</a> from docker hub. We also define and pass the required environment variables and provide defaults for all but the sink URL because you will get a unique URL when you use an online service such as <a href="https://webhook.site/">Webhook</a> or <a href="https://public.requestbin.com/">Pipedream</a>. We provide the workbench configuration to the container by volume mapping it (read-only).</p> <p>Hmmm, what is that last line <code class="language-plaintext highlighter-rouge">network_mode: "host"</code> all about? Well, as stated before, the links in the LDES nodes will be absolute URLs as defined by the <code class="language-plaintext highlighter-rouge">ldes-server.host-name</code> entry in the <a href="../advanced-conversion/server/application.yml">LDES Server configuration file</a> which in this case is <code class="language-plaintext highlighter-rouge">http://localhost:9003/ldes</code>. Because we have exposed the LDES Server to the host system (basically your system) you can request the LDES view and all the nodes from your (host) system just fine. However, the <code class="language-plaintext highlighter-rouge">localhost</code> is a special name which always resolves to IP address 127.0.0.1 as it maps the the loopback adapter of your network card. Essentially, if using its own network, when the LDES Client tries to request a LDES node located on <code class="language-plaintext highlighter-rouge">localhost</code> it will get back it’s loopback address 127.0.0.1 instead of the IP address of the LDES Server. So, the trick we use here is to let the workbench containing our LDES Client share the network of your system (the host) allowing it to resolve to the host network stack and then because of the docker port mapping, your docker will do its magic and forward the HTTP request to the LDES Server container. This is a bit of hocus-pocus that we need in this tutorial because we run our LDES Server locally and do not expose it using a domain name. In real-life you will not have to do this. In fact, if you would use a LDES which is hosted on the web in this tutorial you could comment out or remove the last line.</p> <p>OK, and now for the missing link: where can you define the mandatory sink URL? Well, that again is docker magic. When you execute docker compose CLI commands docker looks for and uses a file named <code class="language-plaintext highlighter-rouge">.env</code> which should contain the required environment variables. Actually you can use any other file but then you have to pass the name and location of that file to the docker CLI command by additing the <code class="language-plaintext highlighter-rouge">--env-file</code> option, e.g. <code class="language-plaintext highlighter-rouge">--env-file user.env</code>. We have provided a <a href="./.env">.env</a> file. You can fill in the sink URL there and run all docker CLI commands as-is or copy this file to some other file (e.g. <code class="language-plaintext highlighter-rouge">user.env</code>) and pass that file to the docker CLI commands as explained. This is the preferred way to make it explicit that you are providing environment variables which are not provided by default in the docker compose file. So let’s do that.</p> <p>Please open https://webhook.site/ in a browser windows and copy your unique URL. Copy the <code class="language-plaintext highlighter-rouge">.env</code> file to <code class="language-plaintext highlighter-rouge">user.env</code> and fill in your unique URL as the sink URL.</p> <blockquote> <p><strong>Note</strong> that it is a good idea to open the sink in a browser tab which does not store cookies, e.g. Firefox’s private window, Chrome ingocnito tab, etc. just in case you hit a rate limit while trying to run this tutorial. In case you experience this issue you can simply close this browser window and open a new one. That way you will get a new fresh sink unaware of the previous rate limit issue.</p> </blockquote> <p>Now you can run the example using the following command (in a bash shell):</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>clear
docker compose <span class="nt">--env-file</span> user.env up
</code></pre></div></div> <blockquote> <p><strong>Note</strong> that this will start the workbench in the shell and not as a deamon as we did not add the deamon option (<code class="language-plaintext highlighter-rouge">-d</code>) to the command.</p> </blockquote> <p>Once started you will see that the LDES Clients starts following the LDES view:</p> <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>basic-client_ldio-workbench  | 2024-01-23T20:07:16.870Z  INFO 1 --- [           main] b.v.i.ldes.ldio.Application              : Started Application in 6.121 seconds (process running for 6.823)
basic-client_ldio-workbench  | 2024-01-23T20:07:17.304Z  INFO 1 --- [pool-6-thread-1] l.c.s.StartingTreeNodeFinder             : determineStartingTreeNode for: http://localhost:9003/ldes/occupancy/by-page
basic-client_ldio-workbench  | 2024-01-23T20:07:17.685Z  INFO 1 --- [pool-6-thread-1] l.c.s.StartingTreeNodeFinder             : Parsing response for: http://localhost:9003/ldes/occupancy/by-page
</code></pre></div></div> <p>Almost immediately you should see the members start appearing in the online sink. After a little bit, the sink stops receiving members. You have now succesfully <em>replicated</em> the data collection. However, our <a href="../advanced-conversion/workbench/application.yml">parking lot workbench</a> polls the source system frequently and generates 5 new version objects (almost) on each run. So, every 2 minutes you can see these new versions appear in the sink. You are now <em>synchronizing</em> the data collection forever, that is, until the LDES Server system is stopped.</p> <h2 id="and-now-the-end-is-near"> <a href="#and-now-the-end-is-near" class="anchor-heading" aria-labelledby="and-now-the-end-is-near"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> And Now, The End Is Near </h2> <p>Because we did not run the docker container as a deamon, in order to stop the container you need to press <code class="language-plaintext highlighter-rouge">CTRL-C</code>.</p> <p>To bring the containers down:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker compose <span class="nb">rm </span>ldio-workbench <span class="nt">--stop</span> <span class="nt">--force</span> <span class="nt">--volumes</span>
</code></pre></div></div> <p>Of course, you also need to bring down the <a href="../advanced-conversion/README.md#every-end-is-a-new-beginning">LDES Server and related containers</a>.</p> <p>Most webhook services will automatically delete the requests after some time but it is best to cleanup yourself. For webhook.site choose the <code class="language-plaintext highlighter-rouge">Delete all requests...</code> option under the <code class="language-plaintext highlighter-rouge">More</code> menu and confirm the removal of all requests. You can now close the browser window.</p> </main> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0"></p> <div class="d-flex mt-2"> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> <script src="https://cdn.jsdelivr.net/npm/mermaid@9.1.3/dist/mermaid.min.js"></script> <script> var config = {} ; mermaid.initialize(config); window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid')); </script> </body> </html>
